<html>
    <head>
        <title>Powah</title>
    </head>
    <body>
        <h1>Powah!!!</h1>
        <form>
            <input type="button" id="createinvitation" value="create invitation"/>
        </form>
        <textarea id="invitation" style="height:200px; width: 400px;"></textarea>
        <form>
            <input type="button" id="checkinvitation" value="check invitation status"/>
        </form>
        <div>
            <h3>Messages</h3>
            <div id="messages" style="display:flex; flex-direction: column;"></div>
        </div>
        <div id="statusoutput"></div>
        <script type="text/javascript">
            let btn = document.getElementById('createinvitation');
            btn.onclick = async function(evt){
                console.log('clicked');
                let resp = await fetch('/api/create_invitation');
                let json_as_text = await resp.text();
                let inv_area = document.getElementById('invitation');
                inv_area.value = json_as_text;
            }
            let btn_check = document.getElementById('checkinvitation');
            btn_check.onclick = async function(evt){
                console.log('clicked');
                let resp = await fetch('/api/check_invitation');
                let json_as_text = await resp.text();
                let output = document.getElementById('statusoutput');
                output.innerText = json_as_text;
            }
        </script>
        <script type="text/javascript">
            const source = new EventSource('/events');
            source.addEventListener('message', message => {
                console.log('Got', message);
                const msg = document.createElement('span');
                msg.style="background-color: orange; padding: 16px; font-weight: bold; border-radius: 8px; margin-top: 8px; margin-right: 48px;";
                msg.innerHTML = message.data;
                document.getElementById('messages').appendChild(msg);
            })
        </script>
    </body>
</html>